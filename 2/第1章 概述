第1章  概述

1.1 计算机网络在信息时代中的作用

    21世纪的一些重要特征就是数字化、网络化和信息化，它是一个以网络为核心的信息时代。

    这里所说的网络是指“三网”，即电信网络、有线电视网络和计算机网络。

    自从上个世纪90年代以后，以因特网为代表的计算机网络得到了飞速的发展，已从最初的教育科研网络逐步发展成为商业网络，并已成为仅次于全球电话网的世纪第二大网络。···  ··· 可以毫不夸大的说，因特网是人类自印刷术发明以来在通信方面最大的变革。现在人们的生活、工作、学习和交往都已离不开因特网。

    计算机网络向用户提供的最重要的功能有两个，即：1.连通性  2.共享

1.2因特网概述
    1.2.1  网络的网络

        网络（network）  由若干结点（node）和连接这些结点的链路（link）组成。
            网络中的结点可以是计算机、集线器、交换机或路由器等。
        网络和网络还可以通过路由器互连起来，这样就构成了一个覆盖范围更大的网络，即互联网。因此，互联网是网络的网络（network of networks）
            网络把许多计算机连接在一起，而因特网则把许多网络连接在一起。
    1.2.2  因特网发展的三个阶段
        因特网的基础结构大体上经历了三个阶段的演进。但这三个阶段在时间划分上并非截然分开而是有部分重叠的，这是因为网络的演进是逐渐的而不是在某个日期突然发生了变化。

        第一个阶段是从单个网络ARPANET向互联网发展的过程。1969年美国国防部创建的第一个分组交换网ARPANET最初只是一个单个的分组交换网。所有要连接在ARPANET上的主机都直接与就近的结点交换机相连。但到了70年代中期，人们已认识到不可能仅适用一个单独的网络来满足所有的通信问题。于是，ARPA开始研究多种网络（如分组无线电网络）互连的技术，这就导致后来的互联网的出现。这样的互连网就成为现在因特网的雏形。1983年TCP/IP协议成为ARPANET上的标准协议，使得所有使用TCP/IP协议的计算机都能利用互联网通信，因而人们就把1983年作为因特网的诞生时间。1990年ARPANET正式宣布关闭，因为它的试验任务已经完成。
        （两个名词：internet和Internet）
            internet是一个通用名词，泛指由多个计算机网络互连而成的网络。在这些网络协议之间的通信协议可以是任意的。
            Internet是一个专用名词，它指当前全球最大的、开放的、由众多网络相互连接而成的特定计算机网络，它采用TCP/IP协议族作为通信的规则，且前身是美国的ARPANET。

        第二阶段的特点是建成了三级结构的因特网。从1985年起，美国国家科学基金会NSF（NationalScienceFoundation）就围着六个大型计算机中心建设计算机网络，即国家科学基金网NSFNET。它是一个三级计算机网络，分为主干网、地区网和校园网（或企业网）。这种三级计算机网络覆盖了全美国主要的大学和研究所，并且成为因特网中的主要组成部分。1991年，NSF和美国的其他政府机构开始认识到，因特网必将扩大其适用范围，不应仅限于大学和研究机构。世界上的许多公司纷纷接入因特网，使网络上的通信量急剧增大，使因特网的容量已满足不了需要。于是美国政府决定将因特网的主干网转交给私人公司来经营，并开始对接入因特网的单位收费。1992年因特网上的主机超过100万台。1993年因特网主干网的速率提高到45Mb/s（T3速率）。

        第三阶段的特点是逐渐形成了多层次ISP结构的因特网。从1993年开始，由美国政府资助的NSFNET逐渐被若干个商用的因特网主干网替代，而政府机构不再负责因特网的运营。这样就出现了一个新的名词：因特网服务提供者ISP（InternetServiceProvider）。在许多情况下，因特网服务提供者ISP就是一个进行商业活动的公司，因此ISP又常译为因特网服务提供商。ISP拥有从因特网管理机构申请到的多个IP地址（因特网上的主机必须有IP地址才能进行通信），同时拥有通信线路（大的ISP自己建造通信线路，小的ISP向电信公司租用通信线路）以及路由器等联网设备，因此任何机构和个人只要向ISP缴纳规定的费用，就可以从ISP得到所需的IP地址，并通过该ISP接入到因特网。
            三层ISP结构
            最高级别的第一层ISP的服务面积最大，并且还拥有告诉主干网。
            第二层ISP和一些大公司都是第一层ISP的用户。
            第三层ISP又称为本地ISP，它们是第二层ISP的用户，且只拥有本地范围的网络。一般的校园网或企业网以及拨号上网的用户，都是第三层ISP的用户。
            为了使用不同层次ISP经营的网络都能够互通，在1994年开始创建了四个网络接入点NAP（NetworkAccessPoint），分别由四个电信公司经营。网络接入点NAP用来交换因特网上流量。在NAP中安装有性能很好的交换设施（如ATM交换技术）。
            NAP算是最高等级的接入点。它主要向各ISP提供交换设施，使它们能够互相通信。NAP又称对等点（peering point），表示接入到NAP的设备不存在从属关系都是平等的。有些大的ISP绕过NAP直接与另一ISP通信，更快捷。

        一旦某个用户能够接入到因特网，那么他就能够成为一个ISP，他需要做的就是购买一些如调制解调器或路由器这样的设备，让其他用户能够和他相连接。

        因特网已经成为世界上规模最大的增长速率最快的计算机网络，没有人能够准确说出因特网究竟有多大。因特网的迅猛发展始于20世纪90年代。由欧洲原子和研究组织CERN开发的万维网WWW（WorldWideWeb）被广泛使用在因特网上，大大方便了广大非网络专业人员对网络的使用，成为因特网的这种指数级增长的主要驱动力。万维网的站点数目也急剧增长。

        1996年美国的一些研究机构和34所大学提出研制和建造新一代因特网的设想，并宣布在今后5年内用5亿美元的联邦资金实施“下一代因特网计划”，即“NGI计划”（NextGenerationInternetInitative）
            NGI计划要实现的主要目标是：
                1.开发下一代网络结构，以比现有的因特网高100倍的速率连接至少100个研究机构，以比现有的因特网高1000倍的速率连接10个类似的网点。其端到端的传输速率要超过100Mb/s至10Gb/s。
                2.使用更加先进的网络服务技术和开发许多带有革命性的应用，如远程医疗、远程教育、有关能源和地球系统的研究、高性能的全球通信、环境监测和预报、紧急情况处理等。
                3.使用超高速全光网络，能实现更快速的交换和路由选择，同时具有一些实时（realtime）应用保留带宽的能力
                4.对整个因特网的管理和保证信息的可靠性及安全性方面进行较大的改进。
      1.2.3  因特网的标准化工作
          1992年由于因特网不再归美国政府管辖，成立了一个国际性组织叫做因特网协会（InternetSociety，ISOC），以便对因特网进行全面管理以及在世界范围内促进发展和使用。ISOC下面有一个技术组织叫做因特网体系结构委员会IAB（InternetArchitectureBoard），负责管理因特网有关协议的开发。
              IAB下面由设有两个工程部：
                  1.因特网工程部IETF（InternetEngineeringTaskForce）
                      IETF是由许多工作组WG（WorkingGroup）组成的论坛（forum），具体工作由因特网工程指导小组IESG（InternetEngineeringSteeringGroup）管理。这些工作组划分为若干个领域（area），每个领域集中研究某一特定的短期和中期工程问题，主要是针对协议的开发和标准化。
                  2.因特网研究部IRTF（InternetResearchTaskForce）
                      IRTF是由一些研究组RG（ResearchGroup）组成的论坛，具体工作由因特网研究指导小组IRSG（InternetResearchSteeringGroup）管理。IRTF的任务是进行理论方面研究和开发一些需要长期考虑的问题。
          所有的因特网标准都是以RFC的形式在因特网上发表。RFC（RequestForComments）的意思就是“请求评论”。所有的RFC文档都可以从因特网上免费下载。但是，并非所有的RFC文档都是因特网标准，只有一小部分才变成标准。
              制定因特网的正式标准要经过以下的四个阶段：
                  1.因特网草案（InternetDraft），还不是RFC文档。
                  2.建议标准（ProposedStandard），开始成为RFC文档
                  3.草案标准（DraftStandard）
                  4.因特网标准（InternetStandard）
              除了以上三种RFC外还有三种，即历史的、实验的和提供信息的。
1.3  因特网的组成
    从工作方式上看，可以划分为两大块：
        1.边缘部分
            由所有连接在因特网上的主机组成。这部分是用户直接使用的，用来进行通信和资源共享。
        2.核心部分
            由大量网络和连接这些网络的路由器组成。这部分是为边缘部分提供服务的。

    1.3.1因特网的边缘部分
        处于因特网边缘的部分就是连接在因特网上的所有主机。这些主机又称为端系统（endsystem）。
        我们说，主机A和主机B进行通信，实际是指，运行在主机A上的某个程序和运行在主机B上的另一个程序进行通信，也是指，主机A的某个进程和主机B上的另一个进程进行通信。

        在网络边缘的端系统中运行的程序之间的通信方式通常可划分为两大类：
            客户服务器方式（C/S方式）和对等方式（P2P方式）

            1.客户服务器方式
                这种方式在因特网上是最常用的，也是传统的方式。我们在上网发送电子邮件或在网站上查找资料时，都是使用客户服务器方式。
                客户是服务请求方，服务器是服务提供方。
                客户程序：
                    被用户调用后运行，在通信时主动向远程服务器发起通信。因此，客户程序必须知道服务器的地址。
                    不需要特殊的硬件和很复杂的操作系统
                服务器程序：
                    是一种专门用来提供某种服务的程序，可同时处理多个远程或本地客户的请求。
                    系统启动后即自动调用并一直不断地运行着，被动地等待并接受来自各地的客户的通信请求。因此，服务器程序不需要知道客户程序的地址。
                    一般需要强大的硬件和高级的操作系统支持。
                客户与服务器的通信关系建立后，通信可以是双向的，客户和服务器都可发送和接收数据。
            2.对等连接方式
                对等连接（peer-to-peer，简写为P2P）是指两个主机在通信是并不区分哪一个是服务请求方还是服务提供方。只要两个主机都运行了对等连接软件（P2P软件），它们就可以进行平等的、对等连接通信。这时，双方都可以下载对方已经存储在硬盘中的共享文档。因此这种工作方式也称为P2P文件共享。
                实际上，对等连接方式从本质上看仍然是使用客服服务器方式，只是对等连接中的每一个主机既是客户又同时是服务器。

    1.3.2因特网的核心部分
        网络核心部分是因特网中最复杂的部分，因为网络中的核心部分要向网络边缘中的大量主机提供连通性，是边缘部分中的任何一个主机都能够向其他主机通信。
            路由器，是一种专用计算机（不是主机），是实现分组交换的关键构建，其任务是转发收到的分组，这是网络核心部分最重要的功能。   为了弄清分组交换，我们要先介绍电路交换的基本概念，在此基础上再讨论分组交换的特点。
        1.电路交换的主要特点
            在电话问世后不久，人们发现，要让所有的电话机都两两相连是不现实的。
            若N部电话要两两相连，就需要N（N-1）/2对电线。当电话机的数量很大时，这种连接方法需要的电线数量就太大了（与电话机的数量的平方成正比）。
            于是，要使每一部电话能够很方便的和另一部电话进行通信，就应当使用电话交换机将这些电话连接起来。

            交换（switching）就是按照某种方式动态地分配传输线路的资源。
            在使用电路交换打电话之前，必须先拨号建立连接。当拨号的信令通过许多交换机到达被叫用户所连接的交换机时，该交换机就向被叫用户的电话机振铃。在被叫用户摘机且摘机信令传送回到主叫用户所连接的交换机后，呼叫即完成。这时，从主叫端到被叫端就建立了一条连接（物理通路）。这条连接占用了双方通话时所需的通信资源，而这些资源在双方通信时不会被其他用户占用，此后主叫和被叫双方才能互相通电话。正是因为有了这个特点，电路交换对端到端的通信质量有可靠的保证。通话完毕挂机后，挂机信令告诉这些交换机，使交换机释放刚才使用的这条物理通路（即归还刚才占用的所有通信资源）。
            这种必须经过“建立连接（占用通信资源）--->通话（一直占用通信资源）--->释放连接（归还通信资源）”三个步骤的交换方式称为电路交换。

            电路交换的重要特点是，在通话的全部时间内，通话的两个用户始终占用端到端的通信资源。

            当使用电路交换来传送计算机数据时，其线路的传输效率往往很低。这是因为计算机的数据是突发式地出现在传输线路上，因此线路上真正用来传送数据的时间往往不到10%甚至1%。实际上，已被用户占用的通讯线路在绝大部分时间都是空闲的。例如，当用户阅读终端屏幕上的信息或用键盘输入和编辑一份文件时，或计算机正在处理而结果尚未返回时，宝贵的通信线路资源并未被利用而是白白被浪费了。
        2.分组交换的主要特点
            分组交换则采用存储转发技术。
            把一个报文划分为几个分组。通常我们把要发送的整块数据称为一个报文（message）。
            在发送报文之前，先把较长的报文划分成为一个个更小的等长数据段。
            例如，每个数据段为1024bit，在每一个数据段前面，加上一些必要的控制信息组成的首部（header）后，就构成了一个分组（packet）。分组又称为“包”，而分组的首部也可称为“包头”。分组是在因特网中传送数据的数据单元。分组中的“首部”是非常重要的，正是由于分组的首部包含了诸如目的地址和源地址等重要控制信息，每一个分组才能在因特网中独立地选择传输路径。
            （注：在因特网核心部分的路由器之间一般用高速链路相连接，而在网络边缘的主机接入到核心部分则通常以相对较低速率的链路相连接）

            主机和路由器都是计算机，但它们的作用很不一样。主机是为用户进行信息处理的，并且可以和其他主机通过网络交换信息。路由器则是用来转发分组的，即进行分组交换的。

            路由器收到一个分组，先暂时存储下来，再检查其首部，查找转发表，按照首部中的目的地址，找到合适的接口转发出去，把分组交给下一个路由器。这样一步一步地以存储转发的方式，吧分组交付到最终的目的主机。各路由器之间必须经常交换彼此掌握的路由信息，以便创建和维持在路由器中的转发表，使得转发表能够在整个网络拓扑发生变化时及时更新。

            当我们讨论因特网的核心部分中的路由器转发分组的过程时，往往把单个的网络简化为一条链路，而路由器成为核心部分的结点。
            路由器暂时存储的是一个个短分组，而不是整个的长报文。短分组是暂存在路由器的存储器中而不是存储在磁盘中。这就保证了较高的交换速率。
            因特网可以容许非常多的主机同时进行通信，而一个主机中的多个进程（即正在运行中的多道程序）也可以各自和不同主机中的不同进程进行通信。
            注意，分组交换在传送数据之前不必先占用一条端到端的通信资源。分组在哪段链路上传送才占用这段链路的通信资源。分组到达一个路由器后，先暂时存储下来，查找转发表，然后从另一条合适的链路转发出去。分组在传输时就这样一段段地断续占用通信资源，而且还省去了建立连接和释放连接的开销，因而数据的传输效率更高。
            因特网采取了专门的措施，保证了数据的传送具有非常高的可靠性。当网络中的某些结点或链路突然故障，在各路由器中运行的路由选择协议（protocol）能够自动找到其他路径转发分组。

            从以上所述可知，采用存储转发的分组交换，实质上是采用了在数据通信的过程中断续（或动态）分配传输带宽的策略。
            为了提高分组交换网的可靠性，因特网的核心部分常常采用网状拓扑结构，使的当发生网络拥塞
